function RESULT = find_baseprice_TOU( ...
        base_start, base_end, step, ...
        battery_kWh, N_co, beta_SS, N_pv, ...
        TEMP_BSA_file, TOU_excel, sheetNames)

PM_DES = 0.25;

battery_vec = battery_kWh * ones(1,length(N_co));
C_FIX   = sum(Cd_fixcost_FPM(battery_vec, N_co, beta_SS, N_pv));
C_OandM = sum(Cd_OandM_FPM(C_FIX));

for base_price = base_start:step:base_end

    Revenue = 0;
    EnergyCost = 0;

    for i = 1:length(sheetNames)

    % ---- Read total revenue directly from Excel (cell K2) ----
    TotalRev_i = readmatrix(TOU_excel, ...
        'Sheet', sheetNames{i}, ...
        'Range','K2');

    Revenue = Revenue + TotalRev_i;

    % ---- Read TOU price signal ----
    Mtou = readmatrix(TOU_excel,'Sheet',sheetNames{i});
    price_signal = Mtou(:,2);
    price_signal = price_signal(~isnan(price_signal));

    % ---- Net grid energy from BSA ----
    Mbsa  = readmatrix(TEMP_BSA_file,'Sheet',sheetNames{i});
    Egrid = Mbsa(:,9);
    Egrid = Egrid(~isnan(Egrid));

    % ---- Match lengths ----
    N = min(length(price_signal), length(Egrid));
    price_signal = price_signal(1:N);
    Egrid = Egrid(1:N);

    % ---- Energy purchasing cost ----
    price = price_signal * base_price;
    EnergyCost = EnergyCost + sum(price .* Egrid);

end


    Cost = C_FIX + C_OandM + EnergyCost;
    PM   = (Revenue - Cost) / Revenue;

    if PM >= PM_DES
        RESULT.base_price = base_price;
        RESULT.Revenue   = Revenue;
        RESULT.Cost      = Cost;
        RESULT.PM        = PM;
        return;
    end
end

RESULT.base_price = NaN;
RESULT.Revenue = NaN;
RESULT.Cost = NaN;
RESULT.PM = NaN;

end
